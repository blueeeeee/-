<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>QQ列表</title>
	<style type="text/css">	
	    div,ul,li,h2{padding: 0;margin:0;font-family:'宋体' }	
		div{height:500px;width:200px;margin: 0 auto;}
		ul{width: 200px;}
		h2,li{line-height:2em;cursor: hand;}
		h2{background:#6CA6CD url(plus.png) no-repeat 5px 16px;padding-left:40px; font-size: 24px;}
		li{list-style-type: none;}
		div ul li li{border-bottom:1px solid #6CA6CD;}
		.uls{display:none;background: #E0EEE0;text-indent: 40px;}
		.h2s{background:#6CA6CD url(minus.png) no-repeat 5px 16px;}
		.lis{background:#DDA0DD;}
	</style>
</head>
<body>
<div>
	<ul>
		<li>
			<h2>朋友</h2>
			<ul class="uls">
				<li>张三</li>
				<li>李四</li>
				<li>王二</li>
				<li>黄一</li>
			</ul>
		</li>
	</ul>
	<ul>
		<li>
			<h2>家人</h2>
			<ul class="uls">
				<li>张三</li>
				<li>李四</li>
				<li>王二</li>
				<li>黄一</li>
			</ul>
		</li>
	</ul>
	<ul>
		<li>
			<h2>同学</h2>
			<ul class="uls">
				<li>张三</li>
				<li>李四</li>
				<li>王二</li>
				<li>黄一</li>
			</ul>
		</li>
	</ul>
</div>
<script type="text/javascript">
	window.onload=function(){
		var aH2=document.getElementsByTagName('h2');
		var aUl=document.getElementsByClassName('uls');
        var arrLi=[];
        //!!!用两层循环先找到要用到的嵌套在里面的li
		for(var i=0;i<aUl.length;i++){
            aLi=aUl[i].getElementsByTagName('li');
            for(var j=0;j<aLi.length;j++){
            	arrLi.push(aLi[j]);
            }
		}
        //点击h2
		for(var i=0;i<aH2.length;i++){
			aH2[i].index=i;
			aH2[i].onclick=function(){
			    var now=this.index;				
				if(/*aUl[now].style.display=='none'*/this.className==''){//通过ul或h2来判断	
					for(var i=0;i<aH2.length;i++){//for循环先清空所有样式再给当前点击的添加样式
						aUl[i].style.display='none';
						aH2[i].className='';
					}		
					aUl[now].style.display='block';//通过h2的index找到同级指定的ul
					this.className='h2s';					
				}else{					
					aUl[now].style.display='none';
					this.className='';
				}
			}
		}
		//!!!点击li
		var onOff=true;//使用定义一个开关的方式来判断，不是通过类名
        for(var i=0;i<arrLi.length;i++){
        	arrLi[i].onOff=true;
        	arrLi[i].onclick=function(){	
                if(this.onOff){
                    for(var i=0;i<arrLi.length;i++){
                        arrLi[i].className='';
                        arrLi[i].onOff=true;/*解决bug,有时鼠标点击li无效*/
                    }
                    this.className='lis';//给当前点击的li添加类                   
                    this.onOff=false;//切换开关状态，便于类的转换
                }else{
                	this.className='';//如果开关为false，即为有类的的状态，再次点击清空类
                	this.onOff=true;
                }
        	}
        }
	}
</script>
</body>
</html>

